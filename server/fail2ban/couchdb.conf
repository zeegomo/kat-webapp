# Fail2ban filter for CouchDB authentication failures
# Detects 401 Unauthorized responses in Nginx access logs
#
# Install: cp couchdb.conf /etc/fail2ban/filter.d/

[Definition]

# Match 401 responses for any HTTP method
# Log format: IP - - [date] "METHOD /path HTTP/1.1" 401 ...
failregex = ^<HOST> - .* "(GET|POST|PUT|DELETE|HEAD|OPTIONS) .* HTTP/[0-9.]+" 401

# Ignore legitimate requests (empty for now)
ignoreregex =

# Date pattern for Nginx combined log format
datepattern = {^LN-BEG}

# Author: KAT Project
